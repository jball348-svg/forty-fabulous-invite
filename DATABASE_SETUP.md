# Database Setup Guide - Supabase

This guide will help you set up a persistent Supabase database for your RSVP data.

## Why Supabase?
- **Free tier** with generous limits
- **Real database** (PostgreSQL) - data persists across deployments
- **Easy setup** - no credit card required for free tier
- **Perfect for Vercel** - works seamlessly with serverless functions

## Step 1: Create Supabase Account

1. Go to [supabase.com](https://supabase.com)
2. Click "Start your project" 
3. Sign up with GitHub or Google
4. Click "New Project"

## Step 2: Create Database

1. Choose your organization (or create a new one)
2. Enter project details:
   - **Project Name**: `forty-fabulous-rsvp`
   - **Database Password**: Generate a secure password (save it!)
   - **Region**: Choose closest to your users
3. Click "Create new project"
4. Wait for setup (2-3 minutes)

## Step 3: Create RSVP Table

Once your project is ready:

1. Go to **SQL Editor** in the left sidebar
2. Click "New query"
3. Paste this SQL and run it:

```sql
-- Create RSVPs table
CREATE TABLE rsvps (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name TEXT NOT NULL,
  attending TEXT NOT NULL CHECK (attending IN ('yes', 'no')),
  submitted_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Create index for better performance
CREATE INDEX idx_rsvps_submitted_at ON rsvps(submitted_at DESC);
```

## Step 4: Get API Keys

1. Go to **Settings** → **API** in the left sidebar
2. You'll need these values:
   - **Project URL** (looks like `https://xxx.supabase.co`)
   - **anon public** key (starts with `eyJ...`)
   - **service_role** key (starts with `eyJ...` - keep this secret!)

## Step 5: Set Environment Variables

### In Vercel Dashboard:
1. Go to your Vercel project
2. Go to **Settings** → **Environment Variables**
3. Add these variables:

```
SUPABASE_URL=your-project-url
SUPABASE_ANON_KEY=your-anon-key  
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
```

### For Local Development:
Create a `.env.local` file in your project root:

```env
VITE_SUPABASE_URL=your-project-url
VITE_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_URL=your-project-url
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
```

## Step 6: Deploy

1. Commit all changes to git
2. Push to GitHub
3. Vercel will auto-deploy with the new environment variables
4. Your `/admin` page will now use the persistent database!

## Testing

1. Visit your site and submit an RSVP
2. Check the `/admin` page - you should see the RSVP
3. In Supabase dashboard, go to **Table Editor** → `rsvps` to verify data
4. Redeploy your app - data should still be there!

## Benefits

✅ **Data persists** across deployments  
✅ **Real database** with proper indexing  
✅ **Scalable** - can handle thousands of RSVPs  
✅ **Backup included** - Supabase handles backups  
✅ **Free tier** - no cost for your use case  

## Troubleshooting

- **API connection errors**: Double-check environment variables
- **Table not found**: Run the SQL setup script again
- **Permission denied**: Ensure you're using the service_role key for server operations

Need help? Check the Supabase docs or ask me!
